name: Package Check
description: Checks which packages have been modified.

inputs:
  bot-token:
    description: Bot token
    required: true

  working-directory:
    description: Root directory for repo.
    required: true

  pr:
    description: PR for this check.
    required: true

outputs:
  package_name:
    description: Package name with changes in PR
    value: ${{ steps.check.package }}

runs:
  using: composite

  steps:
    - name: Package Check
      id: check
      shell: bash
      working-directory: ${{ inputs.working-directory }}
      env:
        GH_TOKEN: ${{ inputs.bot-token }}
      run: |
        cd scripts
        pwd

        filtered=$(dart package_filter.dart \
          --pr "${{ inputs.pr }}" \
          --working-directory "${{ inputs.working-directory }}")

        echo "$filtered"
        echo "package=$filtered" >> "$GITHUB_OUTPUT"
